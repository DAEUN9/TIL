## HTTP 메서드

- **HTTP API를 만들어보자**

  - API URI 설계

    - 가장 중요한 것은 리소스 고민
    - 회원이라는 개념 자체가 리소스
    - 회원 CRUD 모두 배제하고 리소스만 매핑

  - 리소스 식별, URI 계층 구조 활용

    - 리소스와 행위를 분리

    

- **HTTP 메서드 - GET, POST**

  -  주요 메서드
    - `GET` : 리소스 조회
    - `POST` : 요청 데이터 처리, 주로 등록에 사용
    - `PUT` : 리소스 대체, 해당 리소스가 없으면 생성
    - `PATCH` : 리소스 부분 변경
    - `DELETE` : 리소스 삭제
  - 기타 메서드
    - `HEAD`, `OPINIONS`, `CONNECT`, `TRACE`
  - GET
    - 리소스 조회
    - 서버에 전달하고 싶은 데이터는 `query`로 전달
  - POST
    - 메시지 바디를 통해 서버로 요청 데이터 전달
    - 서버는 요청 데이터를 처리
    - 주로 신규 리소스 등록, 변경 프로세스 처리

  - POST : 요청 데이터를 어떻게 처리한다는 뜻일까?

    - HTML 양식에 입력 된 필드와 같은 데이터 블록을 데이터 처리 프로세스에 제공
    - 게시판 글쓰기, 댓글 쓰기
    - 서버가 아직 식별하지 않은 새 리소스 생성
    - 기존 자원에 데이터 추가

  - POST 정리

    1. 새 리소스 생성(등록)

    2. 요청 데이터 처리

       - 단순히 데이터를 생성하거나, 변경하는 것을 넘어서 프로세스를 처리해야 하는 경우
       - ex) 주문에서 결제완료 -> 배달 시작 -> 배달 완료
       - 새로운 리소스가 생성되지 않을 수 있음
       - 동사 URI(컨트롤 URI) : 어쩔 수 없이 쓸 수 있음

    3. 다른 메서드로 처리하기 애매한 경우

       - GET메서드를 사용하기 어려운 경우

       

- **HTTP 메서드 - PUT, PATCH, DELETE**

  - PUT
    - 리소스가 있으면 완전히 대체, 없으면 생성 -> 덮어버림
      - 없는 필드는 그냥 덮어버림
    - **클라이언트가 리소스를 식별**
      - 클라이언트가 리소스의 위치를 알고 URI 지정
      - POST와 차이점
  - PATCH
    - 리소스 부분 변경
  - DELETE
    - 리소스 제거

- **HTTP 메서드의 속성**

  - 안전(Safe Methods)
    - 여러번 호출돼도 리소스 변경이 일어나지 않음
    - 로그가 쌓여서 장애가 발생하는 것은 고려하지 않음
  - 멱등(Idempotent Methods)
    - 한 번 호출하든 100번 호출하든 결과가 똑같다.
    - 멱등 메서드
      - `GET`
      - `PUT` : 결과를 대체하기 때문에 여러번 요청해도 최종 결과 같음
      - `DELETE`
      - `POST`는 멱등이 아니다!! 두 번 호출하면 중복해서 발생
    - 활용
      - 자동 복구 메커니즘
      - 서버가 TIMEOUT등으로 정상 응답을 못주었을 때, 알아서 다시 요청해도 되는가
    - 외부 요인으로 중간에 리소스가 변경되는 것 까지는 고려하지 않음
  - 캐시가능(Cacheable Methods)
    - 응답 결과 리소스를 캐시해서 사용해도 되는가?
    - `GET`, `HEAD`, `POST`, `PATCH` 캐시 가능
    - 실제로는 `GET`, `HEAD` 정도만 캐시로 사용
      - URL만 키로 잡고 캐시하면 됨
      - `POST`, `PATCH`는 본문내용 까지 캐시 키로 사용해야해서 구현 어려움

